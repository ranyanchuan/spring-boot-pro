<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" ><mapper namespace="com.yyan.dao.UserDao">    <!--插入一条用户数据,返回 id-->    <insert id="insertUser" parameterType="com.yyan.pojo.User">        <!-- mysql插入数据后，获取id -->        insert into user(id, name,password,status,email,create_time,update_time) values        (#{id}, #{name},#{password},#{status},#{email}, now(), now())    </insert>    <!--批量插入用户数据-->    <insert id="insertListUserRole">        insert into user(id, name,password,status,email,create_time,update_time) values        <foreach collection="list" item="user" separator=",">            (uuid(), #{user.name},#{user.password},#{user.status},#{user.email}, now(), now())        </foreach>    </insert>    <!--批量查询用户带上用户角色-->    <!--查询条件-->    <sql id="selectListUserRoleCondition">        <if test="id != null">            and id= #{id}        </if>        <if test="email != null">            and email=#{email}        </if>        <if test="status != null">            and status=#{status}        </if>        <if test="name != null">            and name like '%${name}%'        </if>    </sql>    <!--查询 通过用户 id 的关联用户角色表-->    <resultMap type="com.yyan.pojo.User" id="getUserRoleMap">        <id property="id" column="id"/>        <result property="name" column="name"/>        <result property="email" column="email"/>        <result property="createTime" column="createTime"/>        <result property="updateTime" column="updateTime"/>        <collection property="role" ofType="java.util.HashMap" column="list">            <id property="id" column="roleId"/>            <result property="title" column="roleTitle"/>        </collection>    </resultMap>    <select id="selectListUserRole" resultMap="getUserRoleMap">        SELECT        u.id as id,        u.name as name,        u.email as email,        u.create_time as createTime,        u.update_time as updateTime,        r.id as roleId,        r.title as roleTitle        FROM (select * from user where 1=1        <include refid="selectListUserRoleCondition"/>        limit ${pageIndex*size},${(pageIndex+1)*size}        ) u        LEFT JOIN user_role ur        ON u.id = ur.user_id        LEFT JOIN role r        ON ur.role_id = r.id        WHERE 1=1    </select>    <!--获取总条数-->    <!--查询分页总条数-->    <select id="countListUserRole" parameterType="java.util.HashMap" resultType="java.lang.Integer">        select count(id) from user WHERE 1=1        <include refid="selectListUserRoleCondition"/>    </select></mapper>