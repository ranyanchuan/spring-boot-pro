<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.yyan.dao.UserDao">

    <!--添加用户-->
    <insert id="insertUser" parameterType="com.yyan.pojo.User">
        insert into user(id, name,password,status,email,create_time,update_time)
            values(#{id}, #{name},#{password},#{status},#{email},#{createTime},#{updateTime})
    </insert>

    <!--查询所有用户的角色-->
    <select id="queryUserRoleList" resultType="com.yyan.pojo.User">
        select
        u.id as id,
        u.name as name,
        user_id as userId from
        yaoyan.user u,
        yaoyan.user_role ul WHERE 1=1
        <if test="id != null">
            and id= #{id}
        </if>
        <if test="email != null">
            and email=#{email}
        </if>
        <if test="status != null">
            and status=#{status}
        </if>
        <if test="name != null">
            and title like '%${name}%'
        </if>
        limit ${pageIndex*size},${(pageIndex+1)*size};
    </select>

    <!--查询所有用户-->
    <select id="getAllUser" resultType="com.yyan.pojo.User">
        select
        id,
        name,
        status,
        email,
        create_time as createTime,
        update_time as updateTime from user WHERE 1=1
        <if test="id != null">
            and id= #{id}
        </if>
        <if test="email != null">
            and email=#{email}
        </if>
        <if test="status != null">
            and status=#{status}
        </if>
        <if test="name != null">
            and title like '%${name}%'
        </if>
        limit ${pageIndex*size},${(pageIndex+1)*size};
    </select>


    <!--查询分页总条数-->
    <select id="selectCount" parameterType="java.util.HashMap" resultType="java.lang.Integer">
        select count(id) from user WHERE 1=1
        <if test="id != null">
            and id= #{id}
        </if>
        <if test="email != null">
            and email=#{email}
        </if>
        <if test="status != null">
            and status=#{status}
        </if>
        <if test="name != null">
            and title like '%${name}%'
        </if>
    </select>


    <!--查询所有用户-->
    <select id="getUserById" resultType="com.yyan.pojo.User">
      select
        id,
        name,
        status,
        email,
        password,
        create_time as createTime,
        update_time as updateTime
        from user where id=#{id};
    </select>

    <!-- 更新用户-->
    <update id="updateUser" parameterType="com.yyan.pojo.User">
        update user set name=#{name},status=#{status},email=#{email},update_time=#{updateTime}  where id=#{id};
    </update>


    <!-- 更新用户密码-->
    <update id="updateUserPass" parameterType="com.yyan.pojo.User">
        update user set name=#{name},passwrod=#{passwrod},update_time=#{updateTime}  where id=#{id};
    </update>

    <!-- 删除用户-->
    <delete id="deleteUser" parameterType="com.yyan.pojo.User">
        delete from user where id=#{id};
    </delete>


</mapper>
